\input{../template/custom_colors.tex}

% ==========================================================================
\begin{frame}{Optimal Control: Discrete-Time Systems}
	Given the time points $\{ t_0, \ldots, t_N\}$, with interarrivals $\tau_k, \,k \in \{ 0, \ldots, N-1 \} $, the discrete-time state space equations are:

	\bigskip
	\centering
	\(
	\left\{
	\begin{array}{rcl}
		x_{k+1} & = & \overline{A}_k \,x_k + \overline{B}_k\, u_k \\
		x\,(0)  & = & x_0
	\end{array}
	\right.
	\)

	\bigskip
	\pause
	\centering
	\begin{equationboxtext}
		\begin{center}
			\begin{tabular}{@{} l c l @{}}
				$\overline{A}_k = \Phi(\tau_k)$
				$\quad$
				 & $\Phi(\tau) = e^{A\tau}$                                          & \quad State Matrix
				\\[0.6em]
				$\overline{B}_k = \Gamma(\tau_k)$
				$\quad$
				 & $\Gamma(\tau) = \displaystyle\int_0^{\tau} e^{A(\tau-t)}\,dt\, B$
				 & \quad Input Matrix
			\end{tabular}
		\end{center}
		\vspace{-0.4cm}
	\end{equationboxtext}

\end{frame}


% ==========================================================================

\newcommand{\LineMove}{-2.1cm}

\begin{frame}{Performance Index for Discrete-Time Systems}

	% we want to put pause between each of these equation lines, doesn't work -- eq just disappears
	{\small
		\begin{eqnarray*}
			\onslide<1->{&&\hspace{\LineMove}\int_0^T \left( x'(t)\,Q\,x\,(t) + \overline{u}'(t)\,R\,\overline{u}\,(t) \right) dt + x'(T)\,S\,x\,(T)\\}
				\only<1-3>{&& \hspace{\LineMove}= \sum_{k=0}^{N-1} \Bigg[\int_{t_k}^{t_{k+1}} \left( {\color{prediction}x'(t)}\,Q\, {\color{piecewise}x(t)} + \overline{u}'(t)\,R\,\overline{u}\,(t) \right) dt\Bigg] + x'(T)\,S\,x\,(T)\\}
				\only<2-3>{&& \hspace{\LineMove}= \sum_{k=0}^{N-1} \Bigg[ \int_{t_k}^{t_{k+1}} {\color{prediction} \left( \Phi\,x_k + \Gamma\,u_k\right)'}\,Q\, {\color{piecewise}\left( \Phi\,x_k + \Gamma\,u_k \right)}dt + \int_{t_k}^{t_{k+1}} u'_{k} \,R\,u_{k}dt \Bigg] + x'(T)\,S\,x\,(T)\\}
			\onslide<3->{&&\hspace{\LineMove}= \sum_{k=0}^{N-1} \Bigg[x_k' \underbrace{\Bigg( \int_{t_k}^{t_{k+1}} \Phi' Q\, \Phi \, dt \Bigg) }_{\overline{Q}}x_k +u_k'\underbrace{ \Bigg(
					\int_{t_k}^{t_{k+1}} \Gamma' Q \Gamma dt
					+ \underbrace{\int_{t_k}^{t_{k+1}} R dt}_{\tau_k R}
					\Bigg) }_{\overline{R}} u_k + 2 x_k' \underbrace{\Bigg( \int_{t_k}^{t_{k+1}} \Phi' Q\, \Gamma \,dt \Bigg)}_{\overline{P}}u_k\Bigg] + x'(T)\,S\,x\,(T)\\}
		\end{eqnarray*}
	}

		% \begin{tcolorbox}[
		% 		width=13cm,
		% 		colback=darkcerulean!30!white,
		% 		colframe=darkcerulean,
		% 	]
		\onslide<4->{
		\begin{equationbox}[13cm]
			\mathcal{J}(\overline{u}) = \sum_{k=0}^{N-1} \Big( x_k' \,\overline{Q}\, x_k + u_k' \,\overline{R}\, u_k + 2 x_k' \,\overline{P}\, u_k \Big) + x_N' \,S\, x_N
		\end{equationbox}}

\end{frame}
