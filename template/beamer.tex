% Beamer Theme
\usetheme{Boadilla}
\useoutertheme[subsection=false]{miniframes}
\useinnertheme{default}
\usefonttheme{serif}

% Natural numbers start at 0, so 0 is the number of the title page.
\setcounter{framenumber}{-1}

% Fonts
\setbeamerfont{titlelike}{shape=\scshape}
\setbeamerfont{frametitle}{shape=\scshape}

% Colors
\setbeamercolor*{normal text}{fg=black,bg=black!1}
\setbeamercolor*{alerted text}{fg=fireenginered}
\setbeamercolor*{example text}{fg=black}
\setbeamercolor*{structure}{fg=black,bg=black!1}
\setbeamercolor*{section in head/foot}{fg=white, bg=baseblue}
\setbeamercolor*{frametitle}{fg=baseblue, bg=black!1}
\setbeamercolor*{titlelike}{fg=white,bg=baseblue}
\setbeamercolor*{palette tertiary}{fg=black,bg=black!10}
\setbeamercolor*{palette quaternary}{fg=black,bg=black!10}

% Footer
\setbeamertemplate{footline}{}
\beamertemplatenavigationsymbolsempty

% Title page
\setbeamertemplate{title page}{
	\colorlet{titledecocolor}{baseblue!82}
	\colorlet{titlebgcolor}{baseblue}
	\colorlet{titlefgcolor}{baseblue!5}
	\colorlet{titlesubcolor}{baseblue!10}

	\begin{tikzpicture}[remember picture,overlay]
		% Backdrop
		\fill[titlebgcolor] ($(current page.north west)+(0, 3)$) rectangle (current page.south east);
		\begin{scope}
			\foreach \i in {4,...,10} {
					\node[rounded corners,titledecocolor,draw,regular polygon,regular polygon sides=6, minimum size=\i cm,thick] at ($(current page.south east)+(-2.1, 2)$) {} ;
				}
			\foreach \i in {2,...,10} {
					\node[rounded corners,titledecocolor,draw,regular polygon,regular polygon sides=6, minimum size=\i cm,thick] at ($(current page.south east)+(-2.1, 11)$) {} ;
				}
			\node[anchor=center, opacity=0.3, scale=0.65] (label) at ($(current page.south east)+(-2.1, 2)$) {
				\ifdef{\titlepageLogoOverride}{
					\titlepageLogoOverride
				}{
					%\includegraphics{common/owl_titlepage.pdf}
				}
			};
		\end{scope}

		% Title blocks
		\node[titlefgcolor,minimum width=0.65*\paperwidth,anchor=west] at ($(current page.north west)+(1,-3)$){
			\parbox{0.6\paperwidth}{
				\begin{flushleft}
					\LARGE \selectfont \bfseries \inserttitle
				\end{flushleft}
			}
		};
		\node[titlesubcolor,minimum width=0.65*\paperwidth,anchor=west] at ($(current page.north west)+(1,-4.4)$){
			\parbox{0.6\paperwidth}{\large \textit{\insertauthor}}
		};
		\node[titlesubcolor,minimum width=0.65*\paperwidth,anchor=west] at ($(current page.north west)+(1,-5.8)$){
			\parbox{0.6\paperwidth}{\insertinstitute}
		};
		\node[titlesubcolor,minimum width=0.65*\paperwidth,anchor=west] at ($(current page.north west)+(1,-7)$){
			\parbox{0.6\paperwidth}{\insertdate}
		};
	\end{tikzpicture}
}

% Page number
\newcommand{\owlwith}[1]{
	\begin{tikzpicture}
		\node[anchor=south west, inner sep=0] (X) at (0,0){\includegraphics[height=0.75cm]{common/owl_pageno}};
		\node[] (Z) at (0.35,0.36){{\tiny\color{white}#1}};
	\end{tikzpicture}
}
\defbeamertemplate*{logo}{owl}{
	\vspace{-1em}
	\owlwith{\insertframenumber}
}
\newcommand{\nologo}{\setbeamertemplate{logo}{}} % command to set the logo to nothing
\newcommand{\showlogo}{\setbeamertemplate{logo}[owl]} % command to set the logo back to owl if removed previously with \nologo

% Bullet points
\setbeamertemplate{itemize items}{
	\textcolor{baseblue}{$\blacktriangleright$}%
}
\setbeamertemplate{enumerate items}[default]

\newcommand{\fullpagepicture}[1]{\begin{tikzpicture}[remember picture, overlay]
		\node (A) at (current page.center) {\includegraphics[width=\paperwidth, height=\paperheight, keepaspectratio]{#1}};
	\end{tikzpicture}}

% 16:9 aspect ratio
\geometry{paperwidth=170.67mm, paperheight=96mm}
\setbeamersize{text margin left=22.335mm, text margin right=22.335mm}
\textblockorigin{22.335mm}{0mm}

% Reduce indent of description environments
\setbeamersize{description width=0.57cm}

% PDF-PC Notes
% create a new file handle
\newwrite\pdfpcnotesfile
% open file on \begin{document}
\AtBeginDocument{%
	\immediate\openout\pdfpcnotesfile\jobname.pdfpc\relax
	\immediate\write\pdfpcnotesfile{[notes]}
}
% define a # http://tex.stackexchange.com/a/37757/10327
\begingroup
\catcode`\#=12
\gdef\hashchar{#}%
\endgroup
\def\lastframenumber{0}
% define command \pnote{} that works like note but
% additionally writes notes to file in pdfpc readable format
\newcommand{\pnote}[1]{%
	% keep normal notes working
	\note{#1}%
	% if frame changed - write a new header
	\ifdim\theframenumber pt>\lastframenumber pt
		\let\lastframenumber\theframenumber
		\begingroup
		\let\#\hashchar
		\immediate\write\pdfpcnotesfile{\#\#\# \theframenumber}%
		\endgroup
	\fi
	% write note to file
	\immediate\write\pdfpcnotesfile{\unexpanded{#1}}%
}
% close file on \begin{document}
\AtEndDocument{%
	\immediate\closeout\pdfpcnotesfile
}

